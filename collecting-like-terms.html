<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bread Shop Matching Game</title>
    <style>
        body {
            font-family: 'Comic Sans MS', cursive, sans-serif;
            background-color: #FFF8E1;
            margin: 0;
            padding: 20px;
            color: #5D4037;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
            background-color: #FFECB3;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        h1, h2 {
            text-align: center;
            color: #D84315;
        }
        .instructions {
            background-color: #FFE0B2;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
        }
        .game-area {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        .question-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background-color: white;
            padding: 15px;
            border-radius: 10px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .expression {
            font-size: 18px;
            font-weight: bold;
            width: 40%;
        }
        .bread-icon {
            font-size: 24px;
            margin: 0 10px;
        }
        select {
            padding: 8px;
            font-size: 16px;
            border-radius: 5px;
            border: 2px solid #FFA000;
            background-color: #FFF8E1;
            cursor: pointer;
            width: 40%;
        }
        select:focus {
            outline: none;
            border-color: #FF6F00;
        }
        .result {
            display: inline-block;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            margin-left: 10px;
            text-align: center;
            line-height: 30px;
            font-weight: bold;
        }
        .correct {
            background-color: #A5D6A7;
            color: #1B5E20;
        }
        .incorrect {
            background-color: #FFAB91;
            color: #BF360C;
        }
        button {
            display: block;
            margin: 20px auto;
            padding: 12px 24px;
            background-color: #FF9800;
            color: white;
            border: none;
            border-radius: 5px;
            font-size: 18px;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        button:hover {
            background-color: #F57C00;
        }
        .score-display {
            text-align: center;
            font-size: 20px;
            font-weight: bold;
            margin-top: 20px;
            color: #FF6F00;
        }
        .bread-animations {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 100;
        }
        .bread {
            position: absolute;
            font-size: 40px;
            animation: fall 3s linear forwards;
        }
        @keyframes fall {
            0% {
                transform: translateY(-60px) rotate(0deg);
                opacity: 1;
            }
            100% {
                transform: translateY(calc(100vh + 60px)) rotate(360deg);
                opacity: 0;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üçû Bread Shop Matching Game üçû</h1>
        
        <div class="instructions">
            <h2>Instructions</h2>
            <p>Welcome to the Bread Shop! Help the baker collect like terms to prepare the perfect bread recipes. Match each expression on the left with its simplified form on the right.</p>
            <p>For example: <strong>2a + 3a</strong> simplifies to <strong>5a</strong></p>
        </div>
        
        <div class="game-area" id="gameArea">
            <!-- Questions will be dynamically generated here -->
        </div>
        
        <button id="checkButton">Check Answers</button>
        <button id="newQuestionsButton">New Questions</button>
        
        <div class="score-display" id="scoreDisplay"></div>
    </div>
    
    <div class="bread-animations" id="breadAnimations"></div>
    
    <script>
        // Constants for generating random questions
        const variables = ['a', 'b', 'c', 'x', 'y'];
        const themes = [
            'loaves of bread',
            'bread rolls',
            'slices of toast',
            'bread sticks',
            'baguettes',
            'muffins',
            'croissants',
            'bread crumbs'
        ];
        
        // Function to generate a random integer between min and max (inclusive)
        function getRandomInt(min, max) {
            return Math.floor(Math.random() * (max - min + 1)) + min;
        }
        
        // Function to generate a random question
        function generateQuestion() {
            const variable = variables[Math.floor(Math.random() * variables.length)];
            const theme = themes[Math.floor(Math.random() * themes.length)];
            
            // Generate coefficients
            const a = getRandomInt(-10, 10);
            const b = getRandomInt(-10, 10);
            const c = getRandomInt(-10, 10);
            
            // Avoid zero coefficients
            const aCoef = a === 0 ? 1 : a;
            const bCoef = b === 0 ? 2 : b;
            const cCoef = c === 0 ? -1 : c;
            
            // Generate expression with like terms
            let expressionParts = [];
            
            // Add first term
            if (aCoef === 1) expressionParts.push(`${variable}`);
            else if (aCoef === -1) expressionParts.push(`-${variable}`);
            else expressionParts.push(`${aCoef}${variable}`);
            
            // Add second term
            if (bCoef > 0) expressionParts.push(`+ ${bCoef}`);
            else expressionParts.push(`- ${Math.abs(bCoef)}`);
            
            // Add third term
            if (cCoef === 1) expressionParts.push(`+ ${variable}`);
            else if (cCoef === -1) expressionParts.push(`- ${variable}`);
            else if (cCoef > 0) expressionParts.push(`+ ${cCoef}${variable}`);
            else expressionParts.push(`- ${Math.abs(cCoef)}${variable}`);
            
            const expression = expressionParts.join(' ');
            
            // Calculate the simplified result
            const variableCoefficient = aCoef + cCoef;
            const constantTerm = bCoef;
            
            let simplifiedParts = [];
            
            // Add variable term if not zero
            if (variableCoefficient !== 0) {
                if (variableCoefficient === 1) simplifiedParts.push(`${variable}`);
                else if (variableCoefficient === -1) simplifiedParts.push(`-${variable}`);
                else simplifiedParts.push(`${variableCoefficient}${variable}`);
            }
            
            // Add constant term if not zero
            if (constantTerm !== 0) {
                if (constantTerm > 0 && simplifiedParts.length > 0) simplifiedParts.push(`+ ${constantTerm}`);
                else if (constantTerm > 0) simplifiedParts.push(`${constantTerm}`);
                else if (simplifiedParts.length > 0) simplifiedParts.push(`- ${Math.abs(constantTerm)}`);
                else simplifiedParts.push(`${constantTerm}`);
            }
            
            // Handle case where result is 0
            if (simplifiedParts.length === 0) {
                simplifiedParts.push('0');
            }
            
            const simplifiedExpression = simplifiedParts.join(' ');
            
            return {
                expression: `${expression} ${theme}`,
                simplified: `${simplifiedExpression} ${theme}`,
                answer: simplifiedExpression
            };
        }
        
        // Function to generate 5 unique questions
        function generateQuestions(count) {
            const questions = [];
            for (let i = 0; i < count; i++) {
                questions.push(generateQuestion());
            }
            return questions;
        }
        
        // Function to shuffle an array
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }
        
        // Function to create the game interface
        function createGameInterface(questions) {
            const gameArea = document.getElementById('gameArea');
            gameArea.innerHTML = '';
            
            // Get all simplified expressions for the dropdown options
            const allSimplified = questions.map(q => q.simplified);
            
            // Create each question element
            questions.forEach((question, index) => {
                const questionContainer = document.createElement('div');
                questionContainer.className = 'question-container';
                
                const expressionDiv = document.createElement('div');
                expressionDiv.className = 'expression';
                expressionDiv.textContent = question.expression;
                
                const breadIcon = document.createElement('div');
                breadIcon.className = 'bread-icon';
                breadIcon.textContent = 'üçû';
                
                const select = document.createElement('select');
                select.setAttribute('data-index', index);
                select.setAttribute('data-answer', question.answer);
                
                // Add placeholder option
                const placeholderOption = document.createElement('option');
                placeholderOption.value = '';
                placeholderOption.textContent = 'Select the simplified form';
                placeholderOption.selected = true;
                placeholderOption.disabled = true;
                select.appendChild(placeholderOption);
                
                // Add shuffled options
                const shuffledOptions = shuffleArray([...allSimplified]);
                shuffledOptions.forEach(option => {
                    const optionElement = document.createElement('option');
                    optionElement.value = option;
                    optionElement.textContent = option;
                    select.appendChild(optionElement);
                });
                
                const resultDiv = document.createElement('div');
                resultDiv.className = 'result';
                resultDiv.id = `result-${index}`;
                
                questionContainer.appendChild(expressionDiv);
                questionContainer.appendChild(breadIcon);
                questionContainer.appendChild(select);
                questionContainer.appendChild(resultDiv);
                
                gameArea.appendChild(questionContainer);
            });
        }
        
        // Function to check answers
        function checkAnswers() {
            const selects = document.querySelectorAll('select');
            let score = 0;
            
            selects.forEach(select => {
                const index = select.getAttribute('data-index');
                const correctAnswer = select.getAttribute('data-answer');
                const selectedValue = select.value;
                const resultDiv = document.getElementById(`result-${index}`);
                
                // Extract the algebraic expression part without the theme
                const selectedExpression = selectedValue.split(' ')[0];
                
                if (selectedValue && selectedExpression === correctAnswer) {
                    resultDiv.textContent = '‚úì';
                    resultDiv.className = 'result correct';
                    score++;
                } else if (selectedValue) {
                    resultDiv.textContent = '‚úó';
                    resultDiv.className = 'result incorrect';
                } else {
                    resultDiv.textContent = '';
                    resultDiv.className = 'result';
                }
            });
            
            // Update score display
            const scoreDisplay = document.getElementById('scoreDisplay');
            scoreDisplay.textContent = `Score: ${score} out of 5`;
            
            // Show celebration if all correct
            if (score === 5) {
                celebrateSuccess();
            }
            
            return score;
        }
        
        // Function to celebrate success
        function celebrateSuccess() {
            const breadAnimations = document.getElementById('breadAnimations');
            breadAnimations.style.display = 'block';
            breadAnimations.innerHTML = '';
            
            // Create falling bread emojis
            for (let i = 0; i < 20; i++) {
                setTimeout(() => {
                    const bread = document.createElement('div');
                    bread.className = 'bread';
                    bread.textContent = 'üçû';
                    bread.style.left = `${Math.random() * 100}%`;
                    
                    // Randomize animation duration and delay
                    const duration = 2 + Math.random() * 2;
                    bread.style.animationDuration = `${duration}s`;
                    
                    breadAnimations.appendChild(bread);
                    
                    // Remove bread emoji after animation
                    setTimeout(() => {
                        bread.remove();
                    }, duration * 1000);
                }, i * 200);
            }
            
            // Hide animations container after celebration
            setTimeout(() => {
                breadAnimations.style.display = 'none';
            }, 5000);
        }
        
        // Initialize the game
        let currentQuestions = generateQuestions(5);
        createGameInterface(currentQuestions);
        
        // Event listeners
        document.getElementById('checkButton').addEventListener('click', () => {
            checkAnswers();
        });
        
        document.getElementById('newQuestionsButton').addEventListener('click', () => {
            currentQuestions = generateQuestions(5);
            createGameInterface(currentQuestions);
            document.getElementById('scoreDisplay').textContent = '';
        });
    </script>
</body>
</html>
